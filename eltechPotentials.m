fi = randn(2,1);
g = randn(2,2);
y = randn(2,1);

R1 = 100;
R2 = 50;
R3 = 50;
R4 = 50;
R5 = 100;

E1 = 400;
E3 = 400;
E4 = 200;

I = 6;
fi3 = E1;


g11 = 1/R1 + 1/R3 + 1/R5;
g22 = 1/R3 + 1/R4;
g12 = -1/R3;
g21 = g12;
g23 = -1/R4;
g13 = -1/R5;

y11 = -E3/R3;
y22 = -I + E3/R3 - E4/R4;

y11_ = y11 - fi3*g13;
y22_ = y22 - fi3*g23;

y(1,1) = y11_;
y(2,1) = y22_;

g(1,1) = g11;
g(1,2) = g12;
g(2,1) = g21;
g(2,2) = g22;

invG = g^(-1);
fi = invG*y;